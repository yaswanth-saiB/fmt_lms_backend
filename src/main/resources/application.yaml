# ============================================
# SPRING BOOT APPLICATION CONFIGURATION
# ============================================
spring:
  application:
    name: fmt-backend

  # ==========================================
  # DATABASE CONFIGURATION
  # ==========================================
  datasource:
#    url: ${DATABASE_URL}
#    username: ${DATABASE_USERNAME}
#    password: ${DATABASE_PASSWORD}
#    driver-class-name: org.postgresql.Driver
#    hikari:
#      maximum-pool-size: 10
#      minimum-idle: 5
    # Railway will inject these environment variables automaticallyF
    url: jdbc:postgresql://${PGHOST}:${PGPORT}/${PGDATABASE}?sslmode=require
    username: ${PGUSER}
    password: ${PGPASSWORD}
    driver-class-name: org.postgresql.Driver

  server:
    port: ${PORT:8080}  # Railway injects PORT

  # ==========================================
  # JPA CONFIGURATION
  # ==========================================
  jpa:
    hibernate:
      ddl-auto: update
    show-sql: true
    properties:
      hibernate:
        dialect: org.hibernate.dialect.PostgreSQLDialect
        format_sql: true


  thymeleaf:
    prefix: classpath:/templates/
    suffix: .html
    mode: HTML
    encoding: UTF-8
    cache: false  # true in production


# ============================================
# EMAIL CONFIGURATION - 5 MAILBOXES
# ============================================
email:
  otp:
    host: ${OTP_EMAIL_HOST}
    port: ${OTP_EMAIL_PORT}
    username: ${OTP_EMAIL_USERNAME}
    password: ${OTP_EMAIL_PASSWORD}
    from: ${OTP_EMAIL_FROM}

  info:
    host: ${INFO_EMAIL_HOST}
    port: ${INFO_EMAIL_PORT}
    username: ${INFO_EMAIL_USERNAME}
    password: ${INFO_EMAIL_PASSWORD}
    from: ${INFO_EMAIL_FROM}

  help:
    host: ${HELP_EMAIL_HOST}
    port: ${HELP_EMAIL_PORT}
    username: ${HELP_EMAIL_USERNAME}
    password: ${HELP_EMAIL_PASSWORD}
    from: ${HELP_EMAIL_FROM}

  archive:
    host: ${ARCHIVE_EMAIL_HOST}
    port: ${ARCHIVE_EMAIL_PORT}
    username: ${ARCHIVE_EMAIL_USERNAME}
    password: ${ARCHIVE_EMAIL_PASSWORD}
    from: ${ARCHIVE_EMAIL_FROM}

  admin:
    host: ${ADMIN_EMAIL_HOST}
    port: ${ADMIN_EMAIL_PORT}
    username: ${ADMIN_EMAIL_USERNAME}
    password: ${ADMIN_EMAIL_PASSWORD}
    from: ${ADMIN_EMAIL_FROM}

# ============================================
# TWILIO SMS CONFIGURATION
# ============================================
twilio:
  account-sid: ${TWILIO_ACCOUNT_SID}
  auth-token: ${TWILIO_AUTH_TOKEN}
  phone-number: ${TWILIO_PHONE_NUMBER}


# ============================================
# SMS CONFIGURATION
# ============================================
sms:
  max-length: 160
  enable-unicode: false
  country-code: IN

# ============================================
# JWT CONFIGURATION
# ============================================
jwt:
  secret: ${JWT_SECRET}
  access-token-expiration: ${JWT_ACCESS_TOKEN_EXPIRATION:21600000}
  refresh-token-expiration: ${JWT_REFRESH_TOKEN_EXPIRATION:1209600000}

# ============================================
# TOKEN CLEANUP SCHEDULER
# ============================================
scheduling:
  enabled: true

# ============================================
# OTP CONFIGURATION
# ============================================
otp:
  expiry-minutes: 5
  max-attempts: 3
  lockout-minutes: 10
  resend-cooldown-seconds: 60
  length: 6

# ============================================
# DEVICE MANAGEMENT
# ============================================
device:
  max-sessions-per-user: 2
  max-streaming-sessions: 1
  inactive-days: 30

# ============================================
# APPLICATION CONFIGURATION
# ============================================
app:
  base-url: ${APP_BASE_URL:http://localhost:8080}
  frontend-url: ${APP_FRONTEND_URL:http://localhost:3000}
  environment: ${APP_ENVIRONMENT:development}
  enable-bcc: true
  bcc-address: archive@firstmilliontrade.com


# Swagger/OpenAPI Configuration
springdoc:
  api-docs:
    path: /v3/api-docs
    enabled: true
  swagger-ui:
    path: /swagger-ui.html
    enabled: true
    try-it-out-enabled: true
    operations-sorter: method
    tags-sorter: alpha
    disable-swagger-default-url: true
    display-request-duration: true
    # Add this to show authorize button
    persist-authorization: true
  packages-to-scan:
    - com.fmt.fmt_backend.controller  # ✅ CRITICAL - tell Swagger where to scan
  paths-to-match:
    - /api/**  # ✅ Only include API paths

# ============================================
# LOGGING
# ============================================
logging:
  level:
    com.tradingapp: DEBUG
    org.springframework.security: INFO
    org.springframework.mail: DEBUG
  pattern:
    console: "%d{yyyy-MM-dd HH:mm:ss} - %msg%n"